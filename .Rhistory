library(tidyverse)
library(ggplot2)
library(stargazer)
library(plyr)
library(psych)
library(corrplot)
library(corrtable)
library(marginaleffects)
library(quantreg)
# Setting the working directory
setwd("C:/Users/mpasq/OneDrive - Università Politecnica delle Marche/Desktop/Dottorato/TESI/Capitolo 2/Analisi R/Directory")
library(tidyverse)
library(ggplot2)
library(stargazer)
library(plyr)
library(psych)
library(corrplot)
library(corrtable)
library(marginaleffects)
# Setting the working directory
# setwd("C:/Users/mpasq/OneDrive - Università Politecnica delle Marche/Desktop/Dottorato/TESI/Capitolo 2/Analisi R/Directory")
# import data frame from .csv file
data <- read.csv("investData.csv")
###############################
####### Analysis Code ########
###############################
library(tidyverse)
library(ggplot2)
library(stargazer)
library(plyr)
library(psych)
library(corrplot)
library(corrtable)
library(marginaleffects)
# Setting the working directory
setwd("C:/Users/mpasq/OneDrive - Università Politecnica delle Marche/Desktop/Dottorato/TESI/Capitolo 2/Analisi R/Directory")
library(tidyverse)
library(ggplot2)
library(stargazer)
library(plyr)
library(psych)
library(corrplot)
library(corrtable)
library(marginaleffects)
# Setting the working directory
setwd("C:/Users/mpasq/OneDrive - Università Politecnica delle Marche/Desktop/Dottorato/TESI/Capitolo 2/Analisi R/Directory")
library(tidyverse)
library(ggplot2)
library(stargazer)
library(plyr)
library(psych)
library(corrplot)
library(corrtable)
library(marginaleffects)
# Setting the working directory
setwd("C:/Users/mpasq/Dropbox/Tesi Matteo/Investment Game/RICERCA Investment Game/Dati/Codice R/Directory")
# import data frame from .csv file
data <- read.csv("investData.csv")
# Dropping the variable "X", a sequential number automatically generated while creating the .csv file
data = select(data, -1)
# Checking data structure
str(data)
library(tidyverse)
library(ggplot2)
library(stargazer)
library(plyr)
library(psych)
library(corrplot)
library(corrtable)
library(marginaleffects)
# Setting the working directory
setwd("C:/Users/mpasq/Dropbox/Tesi Matteo/Investment Game/RICERCA Investment Game/Dati/Codice R/Directory")
# import data frame from .csv file
data <- read.csv("investData.csv")
# Dropping the variable "X", a sequential number automatically generated while creating the .csv file
data = select(data, -1)
# Checking data structure
str(data)
# All ordinal variables have lost their order in the transition to .csv, so we re-encode them as ordinal variables.
# Also, categorical variables have lost the status as categorical variable, so we re-encode them
###########################################################################
########## PART 1 - DATA HANDLING #########################################
###########################################################################
## Age
table(data$age)
data <- data%>%
mutate(age = case_match(age,
"Between 18 and 24" ~ 21,
"Between 25 and 34" ~ 30,
"Between 35 and 44" ~ 40,
"Between 45 and 54" ~ 50,
"More than 55" ~ 55))
## Gender
data <- data %>%
mutate(gender_female = case_match(gender_fem,
"Female" ~ 1,
"Male" ~ 0,
"Other" ~ 0))
data <- data %>%
relocate(gender_female, .after = gender_fem)
data = select(data, -gender_fem)
## Country
table(data$country)
data <- data %>%
mutate(country = factor(country))
# Income
data <- data %>%
mutate (income = income_bracket)
data <- data%>%
mutate(income = case_match(income,
"<1000 EUR" ~ 1,
"1000-1500 EUR" ~ 1.25,
"1500-2000 EUR" ~ 1.75,
"2000-2500 EUR" ~ 2.25,
"2500-3000 EUR" ~ 2.75,
"3000-5000 EUR" ~ 4,
">5000 EUR" ~ 5))
data <- data%>%
relocate (income, .after=income_bracket)
data = select(data, -income_bracket)
## savings
data <- data %>%
mutate(savings = factor(savings, ordered = TRUE,
levels = c("<10% of income",
"10-30% of income",
" >30% of income")))
# converting "savings" into a numerical variable
data <- data%>%
mutate(savings = as.character(savings))
data <- data%>%
mutate(savings = case_match(savings,
'<10% of income' ~ 10,
'10-30% of income' ~ 20,
'>30% of income' ~ 30))
# it can't convert '>30% of income' into 30, so i'll replace na values with 30 manually
data$savings[is.na(data$savings)] <- 30
# Debt
data <- data %>%
mutate(debt = family_hasDebt)
data <- data %>%
mutate(debt = case_match(debt,
"1 - Totally Disagree" ~ 1,
"2 - Disagree" ~ 2,
"3 - Neither Agree or Disagree" ~ 3,
"4 - Agree" ~ 4,
"5 - Totally Agree" ~ 5))
data <- data %>%
relocate(debt, .after=family_hasDebt)
data = select(data, -family_hasDebt)
## education
data <- data %>% mutate(education = case_match(education,
"Less than Primary" ~ 0,
"Primary" ~ 5,
"Lower Secondary" ~ 8,
"Upper Secondary" ~ 12,
"Post Secondary" ~ 13,
"Short tertiary" ~ 14,
"Bachelor" ~ 15,
"Masters" ~ 17,
"Doctoral" ~ 20))
## Investor Yes
data <- data %>%
mutate(investoryes = case_match(advisor_reliance,
0 ~ 0,
1 ~ 1,
2 ~ 1,
3 ~ 1))
data <- data %>%
relocate(investoryes, .after = advisor_reliance)
# Advisor_reliance
data <- data %>%
mutate(advisor_reliance = case_match(advisor_reliance,
0 ~ 0,
1 ~ 0,
2 ~ 1,
3 ~ 2))
## owns_sustInvest
data <- data %>%
mutate(owns_sustInvest = case_match(owns_sustInvest,
"Yes" ~ 1,
"No" ~ 0))
## past_sustInvest
data <- data %>%
mutate(past_sustInvest = case_match(past_sustInvest,
"Yes" ~ 1,
"No" ~ 0))
## sust_preference
data <- data%>%
mutate(sust_preference = case_match(sust_preference,
"No" ~ 0,
"Do not know" ~ 1,
"Yes" ~ 1))
## advisor_useful
data <- data %>%
mutate(adv_usefulness = advisor_useful)
data <- data %>%
mutate(adv_usefulness = case_match(adv_usefulness,
"1 - Totally Disagree" ~ 1,
"2 - Disagree" ~ 2,
"3 - Neither Agree or Disagree" ~ 3,
"4 - Agree" ~ 4,
"5- Totally Agree" ~ 5))
data <- data %>% relocate(adv_usefulness, .after=advisor_useful)
data = select(data, -advisor_useful)
## advisor_trustworthy
data <- data %>%
mutate(adv_trustworthiness = advisor_trustworthy)
data <- data %>%
mutate(adv_trustworthiness = case_match(adv_trustworthiness,
"1 - Totally Disagree" ~ 1,
"2 - Disagree" ~ 2,
"3 - Neither Agree or Disagree" ~ 3,
"4 - Agree" ~ 4,
"5- Totally Agree" ~ 5))
data <- data %>% relocate(adv_trustworthiness, .after=advisor_trustworthy)
data = select(data, -advisor_trustworthy)
## trust_SustFunds
data <- data %>% mutate(trusting_Sustfunds = trust_SustFunds)
data <- data %>% mutate(trusting_Sustfunds = case_match(trusting_Sustfunds,
"1- Totally Disagree" ~ 1,
"2 - Disagree" ~ 2,
"3 - Neither Agree or Disagree" ~ 3,
"4 - Agree" ~ 4,
"5 - Totally Agree" ~ 5))
data <- data%>%
relocate(trusting_Sustfunds, .after = trust_SustFunds)
data = select(data, -trust_SustFunds)
## perceived_effect
data <- data %>% mutate(sust_investPositive = perceived_effect)
data <- data %>% mutate(sust_investPositive = case_match(sust_investPositive,
"1- Totally Disagree" ~ 1,
"2 - Disagree" ~ 2,
"3 - Neither Agree or Disagree" ~ 3,
"4 - Agree" ~ 4,
"5 - Totally Agree" ~ 5))
data <- data%>%
relocate(sust_investPositive, .after = perceived_effect)
data = select(data, -perceived_effect)
view(data)
